{% extends "base.html" %}

{% block content %}
    <main class="container">
        <!-- User Info -->
        <section class="user-info">
            <!-- Username and Hitpoints -->
            <div class="row">
                <div class="col s12 offset-m3 m3 flow-text center-align">
                    {{ request.user.username }}
                </div>
                
                <div class="col s12 m3 flow-text center-align">
                    <i class="material-icons flow-text hp-icon">local_hospital</i>
                    
                    {{ user.profile.hitpoints }}/100hp
                </div>
            </div>
            <!-- /Username and Hitpoints -->
            
            <!-- Level and XP -->
            <div class="row">
                <div class="col s12 offset-m3 m3 flow-text center-align">
                    Level {{ user.profile.level_rank }}
                </div>
                
                <div class="col s12 m3 flow-text center-align">
                    <i class="material-icons flow-text xp-icon">grade</i>
                    
                    XP: {{ user.profile.exp_points}}/{{ user.profile.xp_threshold }}
                </div>
            </div>
            <!-- /Level and XP -->          
        </section>
        <!-- /User Info -->
        
        <!-- Heading -->
        <h1 class="center-align">Tasks</h1>
        <!-- /Heading -->
        
        <!-- Add a Task Link -->
        <div class="center-align flow-text">
            <a href="{% url 'tasks:create_task' %}">Add a Task</a>     
        </div>
        <!-- /Add a Task Link -->
        
        <p>Current Login: {{ current_login }}</p>
        
        <p>Login saved in database: {{ last_login }}</p>

        <!-- If the user has tasks, display them -->
        {% if task_list %}
            <ul class="center-align">
            {% for task in task_list %}
                <li><a href="{% url 'tasks:detail' task.id %}">{{ task.task_name }}</a> {{ task.get_task_difficulty_display }}</li>
                
                <td><form method="POST" action="done/{{ task.id }}/{{ task.task_difficulty }}/">{% csrf_token %}<input type="submit" value="Done"></form></td>
                
                <td><form method="POST" action="delete/{{ task.id }}/">{% csrf_token %}<input type="submit" value="Delete"></form></td>
                
                {% if task.done_status %}
                    &#9989;
                {% else %}
                    &#10005;
                {% endif %}
            {% endfor %}
            </ul>
            
        <!-- Else, the user has no tasks -->
        {% else %}
            <p>You currently have no tasks!.</p>
        {% endif %}
    </main>
{% endblock %}